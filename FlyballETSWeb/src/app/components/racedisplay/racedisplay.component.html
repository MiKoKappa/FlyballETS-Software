<div style="position: relative;">
  <ngx-loading [show]="!etsDataService.isConnected" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
  <div class="container" *ngIf="!etsDataService.sessionEnded">
    <div class="row">
      <div class="col-lg-12">
        <div class="alert alert-danger text-center" *ngIf="!etsDataService.isConnected" role="alert">Connecting to FlyballETS, please wait...</div>
      </div>
    </div>
    <div class="row">
      <div class="col-8 col-md-4 text-center">
        <button type="button" class="btn btn-success" (click)="startRace()" [disabled]="startDisabled">Start</button>
        <button type="button" class="btn btn-danger" (click)="stopRace()" [disabled]="stopDisabled">Stop</button>
        <button type="button" class="btn btn-info" (click)="resetRace()" [disabled]="resetDisabled">Reset</button>
        <h4>Race Time</h4>
        <div class="teamTime">
          {{currentRace.elapsedTime | date: 'mm:ss.SSS'}} s<br />
          ({{(currentRace.elapsedTime - currentRace.totalCrossingTime) | date: 'ss.SSS'}} {{currentRace.totalCrossingTime | crossingTime}})
        </div>
        <div class="raceState">
          <span [ngClass]="{'badge': true, 'badge-success': currentRace.raceState == 0, 'badge-warning': currentRace.raceState == 1, 'badge-danger': currentRace.raceState == 2}">
            {{currentRace.raceStateFriendly}}
          </span>
        </div>
      </div>
      <div class="col-4 col-md-2">
        <app-lights></app-lights>
      </div>
      <div class="col-12 col-md-6">
        <h4>Dog details</h4>
          <ul class="list-group">
            <li *ngFor="let dog of currentRace.dogData" [ngClass]="{'list-group-item': true, 'active': dog.running}">
              Dog {{dog.dogNumber + 1}} 
              <div class="form-check checkbox-slider--a checkbox-slider-danger d-inline">
                <label>
                  <input type="checkbox" [(ngModel)]="dog.fault"><span>Fault</span>
                </label>
              </div>
              <div *ngFor="let dogTime of dog.timing; let i = index">
                <ng-container *ngIf="dogTime.crossingTime != 0 || dogTime.time != 0 || i == 0">
                  {{dogTime.time | date: 's.SSS'}} {{dogTime.crossingTime | crossingTime}}<br>
                </ng-container>
              </div>
            </li>
          </ul>
      </div>
    </div>
  </div>
</div>
<div *ngIf="!etsDataService.isConnected && etsDataService.sessionEnded" class="container">
    <div class="alert alert-success text-center" role="alert">
      Session ended.<br>
      <button type="button" class="btn btn-success" (click)="reconnect()" >Reconnect</button>
    </div>
</div>