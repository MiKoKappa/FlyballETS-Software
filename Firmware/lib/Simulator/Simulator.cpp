// file:	Simulator.cpp
//
// summary:	Implements the simulator class. Since this class is memory intensive, it should only be
// included if actual simulation is wished.
#include "Simulator.h"
#include "config.h"
#include "RaceHandler.h"
#include "PROGMEM_readAnything.h"
//#include <avr/pgmspace.h>
/// <summary>
///   Program the interrupt triggers which should be simulated here. See end of file for a collection of records from actual races.
/// </summary>
const SimulatorClass::SimulatorRecord SimulatorClass::SimulatorQueue[60 * NumSimulatedRaces] PROGMEM = {
//Race ID: 2 - 0
{1, -23324, 1},
{2, -8593, 1},
{1, 84204, 0},
{2, 97611, 0},
{1, 3750221, 1},
{2, 3765023, 1},
{2, 3879908, 0},
{1, 3893246, 0},
{1, 7829615, 1},
{2, 7840818, 1},
{2, 7844681, 0},
{2, 7845065, 1},
{2, 7980116, 0},
{1, 7994619, 0},
{1, 7995443, 1},
{1, 7997261, 0},
{1, 8004501, 1},
{1, 8006331, 0},
{2, 11814406, 1},
{1, 11828905, 1},
{2, 11931274, 0},
{1, 11948961, 0},
{1, 36050658, 1},
{2, 36121806, 1},
{1, 36305523, 0},
{1, 36308574, 1},
{2, 36337597, 0},
{2, 36354254, 1},
{1, 36362341, 0},
{2, 36385067, 0},
{2, 36385203, 1},
{2, 36392467, 0},
{2, 38186918, 1},
{1, 38256238, 1},
{2, 38555994, 0},
{1, 38602962, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 3-1
{1, 264714, 1},
{2, 278991, 1},
{1, 370936, 0},
{2, 383890, 0},
{1, 4056912, 1},
{2, 4058506, 1},
{2, 4170736, 0},
{2, 4172137, 1},
{2, 4177587, 0},
{2, 4181254, 1},
{1, 4182530, 0},
{2, 4185121, 0},
{1, 8068628, 1},
{2, 8083566, 1},
{1, 8175593, 0},
{1, 8206386, 1},
{1, 8210025, 0},
{1, 8211824, 1},
{2, 8283716, 0},
{2, 8287542, 1},
{1, 8297033, 0},
{2, 8297178, 0},
{1, 8298832, 1},
{1, 8300650, 0},
{1, 8313333, 1},
{1, 8316968, 0},
{2, 12059938, 1},
{1, 12074151, 1},
{2, 12164879, 0},
{2, 12167531, 1},
{2, 12169380, 0},
{1, 12179718, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 4-2
{1, -141819, 1},
{2, -128276, 1},
{1, -37919, 0},
{1, -37358, 1},
{1, -33677, 0},
{2, -19560, 0},
{1, 3570150, 1},
{2, 3585788, 1},
{1, 3680780, 0},
{1, 3683763, 1},
{1, 3685589, 0},
{2, 3685954, 0},
{2, 3686221, 1},
{1, 3698465, 1},
{2, 3796558, 0},
{1, 3811715, 0},
{1, 7450774, 1},
{2, 7467221, 1},
{1, 7567778, 0},
{2, 7583098, 0},
{2, 7600171, 1},
{1, 7619775, 1},
{2, 7698177, 0},
{1, 7711835, 0},
{2, 11539977, 1},
{1, 11555141, 1},
{2, 11646615, 0},
{2, 11647126, 1},
{2, 11652918, 0},
{1, 11666679, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 5-3
{1, -13616, 1},
{2, 1334, 1},
{1, 96547, 0},
{2, 111243, 0},
{1, 3724856, 1},
{2, 3740017, 1},
{2, 3915883, 0},
{1, 3931590, 0},
{1, 7701874, 1},
{2, 7717480, 1},
{2, 7838768, 0},
{1, 7850566, 0},
{2, 11739095, 1},
{1, 11753472, 1},
{2, 11840715, 0},
{2, 11844152, 1},
{2, 11851867, 0},
{2, 11852042, 1},
{2, 11853899, 0},
{1, 11862991, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 6-4
{1, -117275, 1},
{2, -96668, 1},
{1, -13323, 0},
{1, -8048, 1},
{2, 3028, 0},
{2, 8087, 1},
{2, 9928, 0},
{2, 11741, 1},
{1, 21312, 0},
{2, 35509, 0},
{2, 4541702, 1},
{1, 4560381, 1},
{2, 4660872, 0},
{2, 4661667, 1},
{2, 4665524, 0},
{2, 4668026, 1},
{2, 4669877, 0},
{2, 4672321, 1},
{1, 4680078, 0},
{2, 4684308, 0},
{1, 4686178, 1},
{2, 4710172, 1},
{1, 4819719, 0},
{2, 4834973, 0},
{2, 4835492, 1},
{2, 4837342, 0},
{2, 9154690, 1},
{1, 9173256, 1},
{2, 9273247, 0},
{1, 9290566, 0},
{1, 9436520, 1},
{2, 9453786, 1},
{1, 9516241, 0},
{1, 9531017, 1},
{2, 9535110, 0},
{1, 9538591, 0},
{2, 9546229, 1},
{2, 9553490, 0},
{2, 13741453, 1},
{1, 13761364, 1},
{2, 13842498, 0},
{2, 13847299, 1},
{2, 13850990, 0},
{1, 13866636, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 7-5
{1, -24110, 1},
{2, -7756, 1},
{1, 76066, 0},
{1, 83774, 1},
{2, 93757, 0},
{2, 98440, 1},
{2, 100281, 0},
{2, 105747, 1},
{1, 109467, 0},
{2, 125857, 0},
{2, 127666, 1},
{2, 136818, 0},
{2, 4639729, 1},
{1, 4653897, 1},
{2, 4772360, 0},
{2, 4774266, 1},
{1, 4774784, 0},
{1, 4775455, 1},
{2, 4776199, 0},
{1, 4790149, 0},
{1, 4792713, 1},
{2, 4811278, 1},
{1, 4925786, 0},
{2, 4945658, 0},
{2, 9353151, 1},
{1, 9369940, 1},
{2, 9465685, 0},
{2, 9466957, 1},
{2, 9472750, 0},
{2, 9474655, 1},
{2, 9478525, 0},
{1, 9494720, 0},
{1, 9548884, 1},
{2, 9566678, 1},
{1, 9635846, 0},
{1, 9649058, 1},
{2, 9650076, 0},
{1, 9654742, 0},
{1, 9658403, 1},
{1, 9662068, 0},
{2, 9664559, 1},
{2, 9670016, 0},
{2, 9675166, 1},
{2, 9678642, 0},
{2, 13980506, 1},
{1, 13998006, 1},
{2, 14087138, 0},
{1, 14107209, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 8-6
{1, 161544, 1},
{2, 184776, 1},
{1, 272291, 0},
{1, 275946, 1},
{1, 277794, 0},
{1, 283283, 1},
{2, 301822, 0},
{1, 305307, 0},
{2, 306362, 1},
{2, 327984, 0},
{2, 4955831, 1},
{1, 4959795, 1},
{2, 5108986, 0},
{1, 5112641, 0},
{2, 9501073, 1},
{2, 9506572, 0},
{2, 9507566, 1},
{1, 9518274, 1},
{1, 9525558, 0},
{1, 9525603, 1},
{2, 9616350, 0},
{1, 9630540, 0},
{1, 9634141, 1},
{1, 9641411, 0},
{1, 9695089, 1},
{2, 9712408, 1},
{1, 9778742, 0},
{2, 9797047, 0},
{1, 9797151, 1},
{1, 9800949, 0},
{1, 9806184, 1},
{1, 9809861, 0},
{2, 9810293, 1},
{2, 9817558, 0},
{2, 9824447, 1},
{2, 9826192, 0},
{2, 14139990, 1},
{1, 14155779, 1},
{2, 14239942, 0},
{2, 14244720, 1},
{2, 14246585, 0},
{1, 14261277, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 9-7
{1, 67149, 1},
{2, 88385, 1},
{1, 178667, 0},
{1, 179968, 1},
{2, 195345, 0},
{2, 198135, 1},
{2, 199976, 0},
{2, 201785, 1},
{1, 222147, 0},
{2, 242474, 0},
{2, 4854227, 1},
{1, 4873730, 1},
{2, 4997567, 0},
{1, 5018607, 0},
{1, 5057228, 1},
{2, 5074614, 1},
{1, 5184672, 0},
{2, 5206352, 0},
{2, 9628881, 1},
{1, 9648125, 1},
{2, 9737923, 0},
{2, 9740909, 1},
{2, 9750553, 0},
{1, 9758837, 0},
{1, 9763485, 1},
{2, 9777801, 1},
{1, 9844776, 0},
{2, 9860920, 0},
{1, 9861773, 1},
{1, 9867450, 0},
{1, 9871283, 1},
{1, 9873118, 0},
{2, 9877508, 1},
{2, 9882964, 0},
{2, 9888288, 1},
{2, 9890033, 0},
{2, 14202305, 1},
{1, 14220974, 1},
{2, 14305023, 0},
{2, 14308952, 1},
{2, 14310807, 0},
{1, 14324434, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 10-8
{1, 151159, 1},
{2, 170763, 1},
{1, 260789, 0},
{1, 261796, 1},
{1, 263644, 0},
{1, 265460, 1},
{2, 277726, 0},
{2, 279445, 1},
{1, 308044, 0},
{2, 314177, 0},
{1, 5003230, 1},
{2, 5011029, 1},
{2, 5148396, 0},
{1, 5162824, 0},
{2, 9555075, 1},
{2, 9560570, 0},
{2, 9561250, 1},
{1, 9572239, 1},
{1, 9722664, 0},
{1, 9722926, 1},
{1, 9729138, 0},
{2, 9742563, 0},
{1, 9745613, 1},
{1, 9747508, 0},
{2, 9758857, 1},
{2, 9762493, 0},
{2, 14095599, 1},
{1, 14113614, 1},
{2, 14195099, 0},
{2, 14199218, 1},
{2, 14202917, 0},
{1, 14217217, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 11-9
{1, -155799, 1},
{2, -138812, 1},
{1, -46615, 0},
{2, -32034, 0},
{1, 3682400, 1},
{1, 3687920, 0},
{1, 3688081, 1},
{2, 3689433, 1},
{2, 3806425, 0},
{1, 3817270, 0},
{2, 7773274, 1},
{1, 7791762, 1},
{1, 7947301, 0},
{2, 7958866, 0},
{2, 11983973, 1},
{1, 11997941, 1},
{2, 12099718, 0},
{1, 12114699, 0},
{1, 15140716, 1},
{2, 15157464, 1},
{1, 15259482, 0},
{2, 15274746, 0},
{2, 19180850, 1},
{1, 19194945, 1},
{2, 19303140, 0},
{1, 19320591, 0},
{1, 23463430, 1},
{2, 23479883, 1},
{1, 23586643, 0},
{2, 23606957, 0},
{2, 27823396, 1},
{1, 27841993, 1},
{2, 27957627, 0},
{1, 27975292, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 12-10
{1, -1222, 1},
{2, 12510, 1},
{1, 106174, 0},
{2, 118148, 0},
{2, 3916954, 1},
{1, 3929469, 1},
{1, 4061704, 0},
{2, 4069385, 0},
{2, 4070515, 1},
{2, 4077842, 0},
{2, 4080282, 1},
{2, 4084151, 0},
{1, 7906751, 1},
{2, 7917992, 1},
{1, 8017443, 0},
{2, 8032727, 0},
{2, 8042977, 1},
{1, 8059172, 1},
{2, 8130307, 0},
{2, 8131807, 1},
{2, 8133750, 0},
{1, 8148123, 0},
{2, 11949828, 1},
{1, 11963718, 1},
{2, 12052575, 0},
{2, 12056128, 1},
{2, 12061922, 0},
{1, 12074195, 0},
{1, 13387882, 1},
{2, 13403342, 1},
{1, 13507054, 0},
{2, 13521488, 0},
{2, 17532723, 1},
{1, 17550593, 1},
{2, 17659451, 0},
{1, 17675731, 0},
{1, 24391477, 1},
{2, 24409932, 1},
{1, 24504034, 0},
{2, 24517117, 0},
{2, 28505067, 1},
{1, 28519399, 1},
{2, 28618109, 0},
{1, 28635104, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 13-11
{1, 151258, 1},
{2, 164040, 1},
{1, 260483, 0},
{2, 269941, 0},
{1, 3977131, 1},
{2, 3991835, 1},
{1, 4082209, 0},
{1, 4083983, 1},
{2, 4085086, 0},
{2, 4087505, 1},
{1, 4089381, 0},
{2, 4090988, 0},
{2, 4102490, 1},
{2, 4107644, 0},
{2, 4136253, 1},
{1, 4149656, 1},
{2, 4249740, 0},
{1, 4267172, 0},
{2, 7988667, 1},
{1, 7989877, 1},
{1, 8103442, 0},
{2, 8118802, 0},
{2, 12035295, 1},
{1, 12051014, 1},
{2, 12143843, 0},
{1, 12158868, 0},
{1, 20618953, 1},
{2, 20634873, 1},
{1, 20713249, 0},
{1, 20717703, 1},
{1, 20723225, 0},
{2, 20738759, 0},
{2, 24851910, 1},
{1, 24867504, 1},
{2, 24963044, 0},
{1, 24977946, 0},
{1, 24978999, 1},
{1, 24980835, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 14-12
{1, 32459, 1},
{2, 47583, 1},
{1, 139325, 0},
{2, 154189, 0},
{1, 3891998, 1},
{2, 3900053, 1},
{2, 4012740, 0},
{2, 4017853, 1},
{2, 4021291, 0},
{1, 4021628, 0},
{2, 7949991, 1},
{1, 7968550, 1},
{1, 8128686, 0},
{2, 8141746, 0},
{2, 12045409, 1},
{1, 12062550, 1},
{2, 12158541, 0},
{2, 12159398, 1},
{2, 12161254, 0},
{1, 12175951, 0},
{1, 21989343, 1},
{2, 22003153, 1},
{1, 22093474, 0},
{2, 22106470, 0},
{2, 26226664, 1},
{1, 26241684, 1},
{2, 26335785, 0},
{2, 26339571, 1},
{2, 26341427, 0},
{1, 26354100, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 15-13
{1, 56908, 1},
{2, 72240, 1},
{1, 168993, 0},
{2, 182137, 0},
{1, 3925172, 1},
{2, 3936469, 1},
{2, 4049327, 0},
{2, 4052728, 1},
{2, 4057127, 0},
{1, 4058252, 0},
{1, 7974425, 1},
{2, 7993200, 1},
{2, 8131873, 0},
{2, 8137401, 1},
{2, 8142585, 0},
{1, 8151682, 0},
{2, 12030068, 1},
{2, 12035567, 0},
{2, 12037375, 1},
{1, 12045671, 1},
{2, 12142073, 0},
{1, 12157347, 0},
{1, 20320930, 1},
{2, 20334954, 1},
{1, 20407137, 0},
{2, 20417145, 0},
{2, 20422258, 1},
{1, 20425067, 1},
{2, 20427404, 0},
{1, 20430468, 0},
{2, 20439372, 1},
{2, 20444526, 0},
{2, 24696813, 1},
{1, 24715424, 1},
{2, 24801646, 0},
{2, 24803552, 1},
{2, 24811274, 0},
{1, 24828570, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 17
{1, 74419, 1},
{2, 93710, 1},
{1, 175708, 0},
{1, 184493, 1},
{2, 193974, 0},
{2, 197615, 1},
{2, 199456, 0},
{2, 206752, 1},
{1, 222976, 0},
{2, 238801, 0},
{2, 4849731, 1},
{1, 4865385, 1},
{2, 4981916, 0},
{1, 5017346, 0},
{1, 5210364, 1},
{2, 5221895, 1},
{1, 5338326, 0},
{2, 5353790, 0},
{2, 9747987, 1},
{2, 9755311, 0},
{2, 9756410, 1},
{1, 9765755, 1},
{1, 9902184, 0},
{1, 9913516, 1},
{2, 9916141, 0},
{1, 9917311, 0},
{1, 9919780, 1},
{1, 9923459, 0},
{2, 9928701, 1},
{2, 9932346, 0},
{2, 9936545, 1},
{2, 9940022, 0},
{2, 9941338, 1},
{2, 9943064, 0},
{2, 14255880, 1},
{1, 14275650, 1},
{2, 14352861, 0},
{2, 14366960, 1},
{2, 14370440, 0},
{1, 14382928, 0},
{1, 14386552, 1},
{1, 14390223, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 18-15
{1, 118757, 1},
{2, 136368, 1},
{1, 220885, 0},
{1, 233714, 1},
{2, 243084, 0},
{1, 246572, 0},
{2, 246721, 1},
{1, 247318, 1},
{2, 250390, 0},
{2, 255862, 1},
{2, 261355, 0},
{2, 261491, 1},
{1, 264349, 0},
{2, 279641, 0},
{1, 4955281, 1},
{2, 4970185, 1},
{1, 5079579, 0},
{1, 5087662, 1},
{2, 5232442, 0},
{1, 5250282, 0},
{1, 5254295, 1},
{1, 5259804, 0},
{2, 9508303, 1},
{1, 9526668, 1},
{1, 9528511, 0},
{1, 9529093, 1},
{1, 9643063, 0},
{1, 9647760, 1},
{1, 9653275, 0},
{2, 9654278, 0},
{1, 9663349, 1},
{1, 9665246, 0},
{2, 9675612, 1},
{2, 9679254, 0},
{2, 14022611, 1},
{1, 14037515, 1},
{2, 14117460, 0},
{1, 14141228, 0},
{1, 14142929, 1},
{1, 14146609, 0},
{1, 18194010, 1},
{2, 18214334, 1},
{1, 18336381, 0},
{1, 18346732, 1},
{1, 18348572, 0},
{2, 18355243, 0},
{2, 22897271, 1},
{1, 22917719, 1},
{2, 23046287, 0},
{1, 23065979, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 19-16
{1, 117899, 1},
{2, 136612, 1},
{1, 220570, 0},
{1, 226060, 1},
{1, 229743, 0},
{1, 231564, 1},
{2, 251247, 0},
{2, 253060, 1},
{1, 253595, 0},
{2, 267694, 0},
{1, 4923924, 1},
{2, 4943953, 1},
{2, 5115750, 0},
{2, 5119041, 1},
{2, 5124431, 0},
{1, 5137946, 0},
{1, 5146529, 1},
{1, 5160905, 0},
{2, 9512390, 1},
{1, 9531454, 1},
{1, 9657404, 0},
{1, 9662071, 1},
{1, 9665867, 0},
{2, 9665910, 0},
{1, 9669662, 1},
{1, 9673333, 0},
{2, 9677228, 1},
{2, 9682679, 0},
{2, 9684907, 1},
{2, 9688381, 0},
{2, 14115113, 1},
{1, 14132434, 1},
{2, 14221082, 0},
{1, 14240669, 0},
{1, 18868972, 1},
{2, 18888042, 1},
{1, 18992699, 0},
{2, 19012985, 0},
{2, 23599524, 1},
{1, 23616068, 1},
{2, 23722658, 0},
{2, 23725844, 1},
{2, 23731639, 0},
{1, 23750183, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
//Race ID: 20-17
{1, 148048, 1},
{2, 168775, 1},
{1, 259239, 0},
{1, 273902, 1},
{1, 303080, 0},
{2, 321107, 0},
{2, 5030549, 1},
{1, 5050192, 1},
{2, 5177275, 0},
{1, 5196454, 0},
{1, 5339534, 1},
{2, 5353517, 1},
{1, 5467525, 0},
{2, 5488727, 0},
{1, 9897254, 1},
{2, 9908639, 1},
{2, 10073291, 0},
{2, 10076333, 1},
{2, 10080201, 0},
{1, 10087838, 0},
{2, 14443996, 1},
{1, 14462407, 1},
{2, 14548355, 0},
{1, 14569395, 0},
{1, 19648862, 1},
{1, 19654371, 0},
{1, 19655348, 1},
{2, 19668460, 1},
{1, 19742450, 0},
{2, 19763672, 0},
{1, 19766903, 1},
{1, 19772581, 0},
{2, 19788145, 1},
{2, 19791783, 0},
{2, 24250950, 1},
{1, 24266523, 1},
{2, 24359223, 0},
{2, 24359753, 1},
{2, 24365106, 0},
{1, 24381619, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0},
{0, 0, 0}
   //
};
/// <summary>
///   Initialises this object.
/// </summary>
///
/// <param name="iS1Pin">  Zero-based index of the S1 pin. </param>
/// <param name="iS2Pin">  Zero-based index of the S2 pin. </param>
void SimulatorClass::init(uint8_t iS1Pin, uint8_t iS2Pin)
{
   _iS1Pin = iS1Pin;
   //pinMode(_iS1Pin, OUTPUT);
   //digitalWrite(_iS1Pin, LOW);
   _iS2Pin = iS2Pin;
   //pinMode(_iS2Pin, OUTPUT);
   //digitalWrite(_iS2Pin, LOW);
   _iDataPos = 0;
   _iDataStartPos = 0;
   PROGMEM_readAnything(&SimulatorQueue[_iDataPos], PendingRecord);
   ESP_LOGD(__FILE__, "Simulated Race 0 selected!");
}

/// <summary>
///   Main entry-point for this application. Should be called every main loop cycle if simulation is wished.
/// </summary>
void SimulatorClass::Main()
{
   if (RaceHandler.RaceState == RaceHandler.RESET)
   {
      if (_iDataPos != _iDataStartPos)
      {
         //We've reset a race, reset data position to 0
         _iDataPos = _iDataStartPos;
         PROGMEM_readAnything(&SimulatorQueue[_iDataPos], PendingRecord);
      }
      return;
   }
   if (PendingRecord.llTriggerTime == 0)
   {
      //Pending record doesn't contain valid data, this means we've reched the end of our queue
      return;
   }

   //Simulate sensors  
   if ((PendingRecord.llTriggerTime < 0 && RaceHandler.RaceState == RaceHandler.STARTING) || (PendingRecord.llTriggerTime > 0 && RaceHandler.RaceState == RaceHandler.RUNNING)
      || (RaceHandler.RaceState == RaceHandler.STOPPED && GET_MICROS <= RaceHandler._llRaceEndTime + 2000000))
   {
      while (PendingRecord.llTriggerTime != 0 && PendingRecord.llTriggerTime <= (long long)(GET_MICROS - (RaceHandler.llRaceStartTime - 8000))) //8ms advance added
      {
         ESP_LOGD(__FILE__, "%lld Pending record S%d TriggerTime %lld | %lld", GET_MICROS, PendingRecord.iSensorNumber, RaceHandler.llRaceStartTime + PendingRecord.llTriggerTime, PendingRecord.llTriggerTime);
         RaceHandler._QueuePush({PendingRecord.iSensorNumber, (RaceHandler.llRaceStartTime + PendingRecord.llTriggerTime), PendingRecord.iState});
         //And increase pending record
         _iDataPos++;
         PROGMEM_readAnything(&SimulatorQueue[_iDataPos], PendingRecord);
      }
   }
}

void SimulatorClass::ChangeSimulatedRaceID(uint iSimulatedRaceID)
{
   if (RaceHandler.RaceState == RaceHandler.STOPPED || RaceHandler.RaceState == RaceHandler.RESET)
   {
      _iDataStartPos = 60 * iSimulatedRaceID;
      _iDataPos = _iDataStartPos;
      PROGMEM_readAnything(&SimulatorQueue[_iDataPos], PendingRecord);
      ESP_LOGD(__FILE__, "Simulated Race %i selected!", iSimulatedRaceID);
   }
   return;
}
/// <summary>
///   The simulator class object.
/// </summary>
SimulatorClass Simulator;

